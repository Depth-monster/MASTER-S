# üìä –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GRU –∏ LSTM

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–æ–¥—É–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞. –¢—Ä–∞—Ñ–∏–∫ –±—ã–ª –≤–∑—è—Ç –∏–∑ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ—á–∏—â–µ–Ω –∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –æ–±—É—á–∞—é—â–∏—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π GRU –∏ LSTM.

---

## üîß –ß—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:** Ubuntu 20.04+
- **Python:** –í–µ—Ä—Å–∏—è —Å—Ç—Ä–æ–≥–æ `3.7.4`
- **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:** –£–∫–∞–∑–∞–Ω—ã –≤ `requirements.txt` (—Å–º. –Ω–∏–∂–µ, –∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å)

---

## üì• –®–∞–≥–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
sudo apt update
sudo apt install -y build-essential libssl-dev zlib1g-dev libbz2-dev \
libreadline-dev libsqlite3-dev wget curl llvm libncursesw5-dev xz-utils \
tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev
cd /usr/src
sudo wget https://www.python.org/ftp/python/3.7.4/Python-3.7.4.tgz
sudo tar xzf Python-3.7.4.tgz
cd Python-3.7.4
sudo ./configure --enable-optimizations
sudo make -j$(nproc)
sudo make altinstall
git clone https://github.com/Depth-monster/Network-Traffic-Prediction.git
cd Network-Traffic-Prediction
python3.7 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```
–ó–∞–ø—É—Å–∫:
```bash
python3 main/gru.py 60 20 16 16 16 60
python3 main/lstm.py 60 20 16 16 16 60
```


![image](https://github.com/user-attachments/assets/cd8be04c-ce90-4538-8867-4404a84f0f32)
–ù–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–µ—Ç—Å—è:
60 - look_back - –°–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç–æ—á–µ–∫ –≤—Ä–µ–º–µ–Ω–∏ (–≤ –º–∏–Ω—É—Ç–∞—Ö) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–∞ –º–æ–¥–µ–ª–∏ (Step Back = 60 –º–∏–Ω—É—Ç) 
20 - look_ahead - –°–∫–æ–ª—å–∫–æ —Ç–æ—á–µ–∫ –≤—Ä–µ–º–µ–Ω–∏ –≤–ø–µ—Ä—ë–¥ –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å (Step Ahead = 20 –º–∏–Ω—É—Ç).
16 - neuron1 (encoder) - –ö–æ–ª-–≤–æ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ –ø–µ—Ä–≤–æ–º —Å–ª–æ–µ –º–æ–¥–µ–ª–∏ (—ç–Ω–∫–æ–¥–µ—Ä–µ).
16 - neuron2 (decoder1) - –ö–æ–ª-–≤–æ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ –ø–µ—Ä–≤–æ–º –¥–µ–∫–æ–¥–µ—Ä–µ (decoder layer 1).
16 - neuron3 (decoder2) - –ö–æ–ª-–≤–æ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ –≤—Ç–æ—Ä–æ–º –¥–µ–∫–æ–¥–µ—Ä–µ (decoder layer 2).
60 - time_step - –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —à–∞–≥–∞–º–∏ ‚Äî –æ–±—ã—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å look_back –∏ –Ω—É–∂–µ–Ω –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–ø–∞–ø–∫–∏ timestep_60/ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –≤—ã–≤–æ–¥–∞.

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç gru.py –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:
–ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (data/network_traffic.csv).
–§–æ—Ä–º–∏—Ä—É–µ—Ç –æ–±—É—á–∞—é—â—É—é –≤—ã–±–æ—Ä–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 60 –º–∏–Ω—É—Ç.
–û–±—É—á–∞–µ—Ç GRU-–º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å 20 —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–æ—á–µ–∫.
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏:
1 GRU-—Å–ª–æ–π (16 –Ω–µ–π—Ä–æ–Ω–æ–≤)
2 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö GRU-–¥–µ–∫–æ–¥–µ—Ä–∞ –ø–æ 16 –Ω–µ–π—Ä–æ–Ω–æ–≤
–≤—ã—Ö–æ–¥: TimeDistributed(Dense(1)) –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞.
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ results/gru/timestep_60/lb=60_la=20_ne1=16_ne2=16_ne=16/
values.pickle ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
metrics_comparison.csv ‚Äî MAPE –ø–æ —à–∞–≥–∞–º
–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ lstm.py
![image](https://github.com/user-attachments/assets/e4e60d9f-5be8-45f5-b158-9b876849d50c)

![gru_lstm_vs_real_separate](https://github.com/user-attachments/assets/48332bfd-dcf2-47c7-a813-3ad41f596fe6)
![mape_comparison_gru_lstm](https://github.com/user-attachments/assets/e683b6bb-c062-4053-936d-da8cec6dad7d)
![mape_summary_table](https://github.com/user-attachments/assets/30f54cde-7151-4f62-bc92-959f20dec2db)


